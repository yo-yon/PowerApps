検温報告アプリについて
---
## 概要
Power Appsで作成したアプリから検温結果を報告することで自動的に発熱報告のピックアップと未検温者ピックアップがされ所定のTeamsチャネルに対象者が投稿される仕組みになっています。

## 作成した背景
今回、この検温報告アプリを作成した背景としては新型コロナウィルスの感染拡大を受け、4/1より会社で検温報告が義務付けされたことです。

会社ではYammerにて社内の情報共有をしており、当初はYammer上に保管したExcelファイルへ検温結果を入力するという予定でしたがPCを支給されていない社員に関してはスマホのアプリから直接Excelを編集することができず、またPCでも他の人の箇所に誤って記載するなど多くの問題点を抱えていました。

これらの問題点を解消すると同時により後々、カスタマイズしやすいようにPower Appsを用いてこのアプリを作成するに至りました。

# 検温報告アプリのインストール手順
## 1. Sharepointサイトの構築

### 1-1. Sharepointサイトの作成
検温報告データをためる為のサイトを構築します。

1. [Office365ホーム](https://www.office.com/)からSharepointを選択します。

1. 「サイトの作成」を選択し、「次へ」をクリックします。

1. 「チームサイト」を選択します。

1. サイト名と説明を入力します。

1. プライバシー設定は全社員がアクセスできるように「パブリック」を選択します。

1. 「次へ」をクリックします。

1. 必要に応じてサイト所有者を追加します。

1. 「完了」をクリックします。

これでデータをためる為のサイトは作成できました。

次にアプリ用にSharePointのカスタムリストを作成します。

3種類のカスタムリストが必要となる為、カスタムリストの作成にはPower Automateフローを利用します

### 1-2. SharePointリスト作成用のPower Automateフローインポート

1. [Power Automate](https://flow.microsoft.com/)にアクセスします。

1. 「マイフロー」をクリックします。

1. 「インポート」をクリックします。

1. 検温報告用リスト作成.zipをアップロードします

1. インポートしたフローに対して「インポート時に選択」をクリックしSharePointの接続を追加します。

1. もし既存のSharePoint接続が無い場合は、「+新規作成」をクリックし、接続を作成します。

1. 別のタブが開くので「+新しい接続」をクリックします。

1. 「SharePoint」と検索し、選択します。
 
　　データを接続する方法は「直接接続(クラウドサービス)」を選択し、「作成」をクリックします。

1. 作成した接続を選択します。

1. 保存をクリックします。

1. インポートをクリックします。

### 1-3. SharePointリスト作成用のフローを編集

1. インポートが完了したら「マイフロー」へアクセスし、フローの一覧を更新します。

1. インポートした「検温報告用リスト作成」フローを選択します。

1. 「編集」をクリックします。

1. 「リストを作成するSharePointサイトの指定」をクリックします。

1. 「値」を1-1で作成したSharePointサイトのURLに変更してください。

1. 「保存」をクリックします。

### 1-4. 「検温報告用リスト作成」フローを実行する

1. 「検温報告用リスト作成」フローの詳細画面に戻ります。

1. 「実行」をクリックします

1. 画面右側に「フローの実行」と表示されるのでクリックします

エラーが出なければリストの作成は完了です。

SharePointのサイトコンテンツを確認して頂ければ下記の3つのリストができているはずです。

| リスト名| 説明 |
----|----
| Employee_list | 社員リストです。所属している社員の情報を入力して下さい。 |
| Workprohibition_list | 出勤停止者リストです。37.5℃以上の発熱があった場合、自動的にこのリストに格納されます。 |
| BodyTempMeasurementResult_list |検温報告リストです。検温報告アプリで入力された内容が格納されます。 |

## 2. 検温報告アプリのインポートと設定

1で検温報告アプリの結果をためておく箇所が作成されたので次にアプリのインポートを行い、使用する為の設定を行います。

### 2-1. 「検温報告」アプリのインポート

1. [Power Apps](https://make.powerapps.com/)にアクセスします。

1. 左側のメニューから「アプリ」を選択します。

1. コマンドバーに表示されている「キャンバスアプリのインポート」をクリックします。

1. 「アップロード」をクリックします。

1. 「検温報告」.zipを選択します。

1. 「関連リソース」でエラーになっている接続に対し、「インポート時に選択する」をクリックし、接続を選択します。
　　
  　接続が無い場合は新規で作成して下さい。
   
1. 「インポート」を選択します。

### 2-2. 「検温報告」アプリのインポート

1. 「アプリ」の一覧画面に戻ります。

1. 「検温報告」アプリで「その他のコマンド(･･･)」を選択します。

1. 表示されたメニューから「編集」をクリックします。

1.サインインするか、必要な接続を作成して、「許可」をクリックします。

1. 左側のWindou でデータソースに移動します。

1. この状態では1で作成したSharePointサイトを差していないのでアプリ内の既存のSharePointリストを削除します。

　　マウスオーバーすると表示される「その他のコマンド(･･･)をクリックし、「削除」をクリックします。

1. 検索欄で「SharePoint」と検索します。

1. 下部に「SharePoint」と表示されるのでそれをクリックします。

1. 










